function generateArticleTable(){wordTable=$("#article-list-table").DataTable({dom:"frtip",ajax:"../rest/website/"+siteID+"/articles",order:[[1,"desc"]],columns:[{data:"id"},{data:"url"}],select:"single"})}function generateWordsTable(){wordTable=$("#word-list-table").DataTable({dom:"frtip",ajax:"../rest/website/"+siteID+"/words",order:[[1,"desc"]],columns:[{data:"word"},{data:"amount"}],select:"single"})}var barChart,lineChart,articleLineChart,siteID,wordTable,startRange,endRange,$chartsSection=$("#charts");$(document).ready(function(){siteID=$("#siteID").val(),generateWordsTable(),generateArticleTable(),getAllWordsForDomain(generateBarChart),getArticleTimeline(generateArticleTimeline),getSiteCrawlingStats(),getSubsiteCrawlingStats()});var getSiteCrawlingStats=function(){$.getJSON("../rest/website/"+siteID+"/stats",function(t){var e=t.data[0];"undefined"!=typeof e&&("undefined"!=typeof e.crawlDuration&&$("#crawl-duration").text(toSeconds(e.crawlDuration)+" s"),"undefined"!=typeof e.avg_article&&$("#avg-article-amount").text(e.avg_article>0?e.avg_article+" articles":e.avg_article+" article"),"undefined"!=typeof e.analyzeDuration&&$("#analyze-duration").text(round2(toMinutes(e.analyzeDuration))+" min"))})},getSubsiteCrawlingStats=function(){$.getJSON("../rest/website/"+siteID+"/avgword",function(t){var e=t.data[0];"undefined"!=typeof e&&("undefined"!=typeof e.avgwordlength&&$("#avg-word-length").text(round2(e.avgwordlength)>0?round2(e.avgwordlength)+" chars":round2(e.avgwordlength)+" char"),"undefined"!=typeof e.avgwords&&$("#avg-word-amount").text(round2(e.avgwords)>0?round2(e.avgwords)+" words":round2(e.avgwords)+"word"))})};$("#fromDate").change(function(){if("undefined"!=typeof $(this).val()){var t=$(this).val().split("-");startRange=t[2]+"."+t[1]+"."+t[0],$("#toDate").removeAttr("disabled"),$("#toDate").attr("min",$(this).val())}}),$("#toDate").change(function(){if("undefined"!=typeof $(this).val()){var t=$(this).val().split("-");endRange=t[2]+"."+t[1]+"."+t[0],getAmountsForSiteWithDateRange(startRange,endRange,generateLineChart)}});var getArticleTimeline=function(t){$.getJSON("../rest/website/"+siteID+"/articles/timeline",function(e){$chartsSection.removeClass("overlay"),t(e.data)})},getAllWordsForDomain=function(t){$.getJSON("/TermStatistics/rest/website/"+siteID+"/words/10",function(e){$chartsSection.removeClass("overlay"),t(e.data)})},getAmountsForSiteWithDateRange=function(t,e,o){$.getJSON("../rest/website/"+siteID+"/period/"+t+"/"+e,function(t){$chartsSection.removeClass("overlay"),o(t)})},generateArticleTimeline=function(t){var e=[],o=[],a={pointDotStrokeWidth:2};$(t).each(function(){e.push($(this)[0].crawldate),o.push($(this)[0].amount)});var r={labels:e,datasets:[{label:"",fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:"#2ECC71",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o}]},i=$("#article-timeline-chart").get(0).getContext("2d");articleLineChart=new Chart(i).Line(r,a)},generateBarChart=function(t){var e=[],o=[];$(t).each(function(a){e.push(t[a].word),o.push(t[a].amount)});var a={labels:e,datasets:[{label:"",fillColor:"rgba(22, 160, 133, 0.6)",strokeColor:"rgba(38, 166, 91, 0.4)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o}]},r=$("#bar-chart").get(0).getContext("2d");barChart=new Chart(r).Bar(a)},generateLineChart=function(t){var e=[],o=[],a={legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></span></li><%}%></ul>'},r=Object.keys(t);$(r).each(function(a,r){var i=[];$(t[r]).each(function(){e.indexOf($(this)[0].date)<0&&e.push($(this)[0].date),i.push($(this)[0].amount)}),o.push(i)});var i=["rgba(38, 166, 91, 0.8)","rgba(34, 167, 240, 0.8)","rgba(219, 10, 91, 0.8)","rgba(108, 122, 137, 0.8)","rgba(207, 0, 15, 0.8)","rgba(247, 202, 24, 0.8)","rgba(242, 38, 19, 0.8)","rgba(154, 18, 179, 0.8)","rgba(249, 105, 14, 0.8)","rgba(34, 49, 63, 0.8)"],l={labels:e,datasets:[{label:r[0],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[0],pointColor:i[0],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[0]},{label:r[1],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[1],pointColor:i[1],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[1]},{label:r[2],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[2],pointColor:i[2],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[2]},{label:r[3],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[3],pointColor:i[3],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[3]},{label:r[4],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[4],pointColor:i[4],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[4]},{label:r[5],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[5],pointColor:i[5],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[5]},{label:r[6],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[6],pointColor:i[6],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[6]},{label:r[7],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[7],pointColor:i[7],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[7]},{label:r[8],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[8],pointColor:i[8],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[8]},{label:r[9],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:i[9],pointColor:i[9],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[9]}]},n=$("#line-chart").get(0).getContext("2d");lineChart=new Chart(n).Line(l,a),$("#line-chart-container").append(lineChart.generateLegend())};