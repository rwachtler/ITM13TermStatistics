function generateArticleTable(){wordTable=$("#article-list-table").DataTable({dom:"frtip",ajax:"../rest/website/"+siteID+"/articles",order:[[1,"desc"]],columns:[{data:"id"},{data:"url"}],select:"single"})}function generateWordsTable(){wordTable=$("#word-list-table").DataTable({dom:"frtip",ajax:"../rest/website/"+siteID+"/words",order:[[1,"desc"]],columns:[{data:"word"},{data:"amount"}],select:"single"})}var barChart,lineChart,articleLineChart,siteID,wordTable,startRange,endRange,$chartsSection=$("#charts");$(document).ready(function(){siteID=$("#siteID").val(),generateWordsTable(),generateArticleTable(),getAllWordsForDomain(generateBarChart),getArticleTimeline(generateArticleTimeline),getSiteCrawlingStats(),getSubsiteCrawlingStats()});var getSiteCrawlingStats=function(){$.getJSON("../rest/website/"+siteID+"/stats",function(t){var e=t.data[0];"undefined"!=typeof e&&("undefined"!=typeof e.crawlDuration&&$("#crawl-duration").text(e.crawlDuration/1e3+" s"),"undefined"!=typeof e.avg_article&&$("#avg-article-amount").text(e.avg_article),"undefined"!=typeof e.analyzeDuration&&$("#analyze-duration").text(e.analyzeDuration/1e3+" s"))})},getSubsiteCrawlingStats=function(){$.getJSON("../rest/website/"+siteID+"/avgword",function(t){var e=t.data[0];"undefined"!=typeof e&&("undefined"!=typeof e.avgwordlength&&$("#avg-word-length").text(Math.round(100*e.avgwordlength)/100+" chars"),"undefined"!=typeof e.avgwords&&$("#avg-word-amount").text(e.avgwords))})};$("#fromDate").change(function(){if("undefined"!=typeof $(this).val()){var t=$(this).val().split("-");startRange=t[2]+"."+t[1]+"."+t[0],$("#toDate").removeAttr("disabled"),$("#toDate").attr("min",$(this).val())}}),$("#toDate").change(function(){if("undefined"!=typeof $(this).val()){var t=$(this).val().split("-");endRange=t[2]+"."+t[1]+"."+t[0],getAmountsForSiteWithDateRange(startRange,endRange,generateLineChart)}});var getArticleTimeline=function(t){$.getJSON("../rest/website/"+siteID+"/articles/timeline",function(e){$chartsSection.removeClass("overlay"),t(e.data)})},getAllWordsForDomain=function(t){$.getJSON("/TermStatistics/rest/website/"+siteID+"/words/10",function(e){$chartsSection.removeClass("overlay"),t(e.data)})},getAmountsForSiteWithDateRange=function(t,e,o){$.getJSON("../rest/website/"+siteID+"/period/"+t+"/"+e,function(t){$chartsSection.removeClass("overlay"),o(t)})},generateArticleTimeline=function(t){var e=[],o=[],a={pointDotStrokeWidth:2};$(t).each(function(){e.push($(this)[0].crawldate),o.push($(this)[0].amount)});var i={labels:e,datasets:[{label:"",fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:"#2ECC71",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o}]},r=$("#article-timeline-chart").get(0).getContext("2d");articleLineChart=new Chart(r).Line(i,a)},generateBarChart=function(t){var e=[],o=[];$(t).each(function(a){e.push(t[a].word),o.push(t[a].amount)});var a={labels:e,datasets:[{label:"",fillColor:"rgba(22, 160, 133, 0.6)",strokeColor:"rgba(38, 166, 91, 0.4)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o}]},i=$("#bar-chart").get(0).getContext("2d");barChart=new Chart(i).Bar(a)},generateLineChart=function(t){var e=[],o=[],a={legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></span></li><%}%></ul>'},i=Object.keys(t);$(i).each(function(a,i){var r=[];$(t[i]).each(function(){e.indexOf($(this)[0].date)<0&&e.push($(this)[0].date),r.push($(this)[0].amount)}),o.push(r)});var r=["rgba(38, 166, 91, 0.8)","rgba(34, 167, 240, 0.8)","rgba(219, 10, 91, 0.8)","rgba(108, 122, 137, 0.8)","rgba(207, 0, 15, 0.8)","rgba(247, 202, 24, 0.8)","rgba(242, 38, 19, 0.8)","rgba(154, 18, 179, 0.8)","rgba(249, 105, 14, 0.8)","rgba(34, 49, 63, 0.8)"],l={labels:e,datasets:[{label:i[0],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:r[0],pointColor:r[0],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[0]},{label:i[1],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:r[1],pointColor:r[1],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[1]},{label:i[2],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:r[2],pointColor:r[2],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[2]},{label:i[3],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:r[3],pointColor:r[3],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[3]},{label:i[4],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:r[4],pointColor:r[4],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[4]},{label:i[5],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:r[5],pointColor:r[5],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[5]},{label:i[6],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:r[6],pointColor:r[6],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[6]},{label:i[7],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:r[7],pointColor:r[7],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[7]},{label:i[8],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:r[8],pointColor:r[8],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[8]},{label:i[9],fillColor:"rgba(22, 160, 133, 0.0)",strokeColor:r[9],pointColor:r[9],pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:o[9]}]},n=$("#line-chart").get(0).getContext("2d");lineChart=new Chart(n).Line(l,a),$("#line-chart-container").append(lineChart.generateLegend())};